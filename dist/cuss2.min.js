var Cuss2=(()=>{var Gt=Object.create;var Oe=Object.defineProperty;var Nt=Object.getOwnPropertyDescriptor;var gt=Object.getOwnPropertyNames;var Lt=Object.getPrototypeOf,vt=Object.prototype.hasOwnProperty;var bt=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Ke=(r,e)=>{for(var t in e)Oe(r,t,{get:e[t],enumerable:!0})},qe=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of gt(e))!vt.call(r,o)&&o!==t&&Oe(r,o,{get:()=>e[o],enumerable:!(n=Nt(e,o))||n.enumerable});return r};var ye=(r,e,t)=>(t=r!=null?Gt(Lt(r)):{},qe(e||!r||!r.__esModule?Oe(t,"default",{value:r,enumerable:!0}):t,r)),Bt=r=>qe(Oe({},"__esModule",{value:!0}),r);var X=bt((An,Fe)=>{"use strict";var q=typeof Reflect=="object"?Reflect:null,pt=q&&typeof q.apply=="function"?q.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Le;q&&typeof q.ownKeys=="function"?Le=q.ownKeys:Object.getOwnPropertySymbols?Le=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Le=function(e){return Object.getOwnPropertyNames(e)};function Ut(r){console&&console.warn&&console.warn(r)}var mt=Number.isNaN||function(e){return e!==e};function A(){A.init.call(this)}Fe.exports=A;Fe.exports.once=Yt;A.EventEmitter=A;A.prototype._events=void 0;A.prototype._eventsCount=0;A.prototype._maxListeners=void 0;var Et=10;function ve(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(A,"defaultMaxListeners",{enumerable:!0,get:function(){return Et},set:function(r){if(typeof r!="number"||r<0||mt(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");Et=r}});A.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};A.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||mt(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ct(r){return r._maxListeners===void 0?A.defaultMaxListeners:r._maxListeners}A.prototype.getMaxListeners=function(){return ct(this)};A.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var o=e==="error",i=this._events;if(i!==void 0)o=o&&i.error===void 0;else if(!o)return!1;if(o){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var p=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw p.context=s,p}var c=i[e];if(c===void 0)return!1;if(typeof c=="function")pt(c,this,t);else for(var P=c.length,u=St(c,P),n=0;n<P;++n)pt(u[n],this,t);return!0};function At(r,e,t,n){var o,i,s;if(ve(t),i=r._events,i===void 0?(i=r._events=Object.create(null),r._eventsCount=0):(i.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),i=r._events),s=i[e]),s===void 0)s=i[e]=t,++r._eventsCount;else if(typeof s=="function"?s=i[e]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),o=ct(r),o>0&&s.length>o&&!s.warned){s.warned=!0;var p=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");p.name="MaxListenersExceededWarning",p.emitter=r,p.type=e,p.count=s.length,Ut(p)}return r}A.prototype.addListener=function(e,t){return At(this,e,t,!1)};A.prototype.on=A.prototype.addListener;A.prototype.prependListener=function(e,t){return At(this,e,t,!0)};function Mt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function lt(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},o=Mt.bind(n);return o.listener=t,n.wrapFn=o,o}A.prototype.once=function(e,t){return ve(t),this.on(e,lt(this,e,t)),this};A.prototype.prependOnceListener=function(e,t){return ve(t),this.prependListener(e,lt(this,e,t)),this};A.prototype.removeListener=function(e,t){var n,o,i,s,p;if(ve(t),o=this._events,o===void 0)return this;if(n=o[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){p=n[s].listener,i=s;break}if(i<0)return this;i===0?n.shift():xt(n,i),n.length===1&&(o[e]=n[0]),o.removeListener!==void 0&&this.emit("removeListener",e,p||t)}return this};A.prototype.off=A.prototype.removeListener;A.prototype.removeAllListeners=function(e){var t,n,o;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var i=Object.keys(n),s;for(o=0;o<i.length;++o)s=i[o],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this};function _t(r,e,t){var n=r._events;if(n===void 0)return[];var o=n[e];return o===void 0?[]:typeof o=="function"?t?[o.listener||o]:[o]:t?wt(o):St(o,o.length)}A.prototype.listeners=function(e){return _t(this,e,!0)};A.prototype.rawListeners=function(e){return _t(this,e,!1)};A.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):ut.call(r,e)};A.prototype.listenerCount=ut;function ut(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}A.prototype.eventNames=function(){return this._eventsCount>0?Le(this._events):[]};function St(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function xt(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function wt(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function Yt(r,e){return new Promise(function(t,n){function o(s){r.removeListener(e,i),n(s)}function i(){typeof r.removeListener=="function"&&r.removeListener("error",o),t([].slice.call(arguments))}dt(r,e,i,{once:!0}),e!=="error"&&Ft(r,o,{once:!0})})}function Ft(r,e,t){typeof r.on=="function"&&dt(r,"error",e,t)}function dt(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function o(i){n.once&&r.removeEventListener(e,o),t(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var pn={};Ke(pn,{Build:()=>D,Cuss2:()=>Me,LogMessage:()=>be,Models:()=>Ye,StateChange:()=>Q,helpers:()=>L,log:()=>R,logger:()=>Rt});var Ye={};Ke(Ye,{AckCodes:()=>Ze,ApplicationStateChangeReasonCodes:()=>xe,ApplicationStateCodes:()=>we,BiometricProviderMessageType:()=>je,BiometricsCharacteristics:()=>et,CardBrand:()=>Qe,CharacteristicsDocumentType:()=>$e,ComponentState:()=>W,ComponentTypes:()=>Ge,CussDataTypes:()=>g,DataStatus:()=>tt,DeviceTypes:()=>Ne,EventCategories:()=>nt,EventModes:()=>rt,EventTypes:()=>it,MediaType:()=>Xe,MediaTypes:()=>ge,MessageCodes:()=>C,NavigationTypes:()=>ot,OperationDocumentType:()=>ze,PaymentsCharacteristics:()=>st,PlatformDirectives:()=>K,SupportedColors:()=>at,TransactionDocumentType:()=>Je});var je=(o=>(o.NONE="NONE",o.REQUEST="REQUEST",o.REQUEST_DATA="REQUEST_DATA",o.RESPONSE="RESPONSE",o))(je||{}),$e=(n=>(n.NONE="NONE",n.REQUEST="REQUEST",n.RESPONSE="RESPONSE",n))($e||{}),Qe=(c=>(c.AMEX="AMEX",c.CART_BLANCHE="CART_BLANCHE",c.DISCOVER="DISCOVER",c.JCB="JCB",c.MAESTRO="MAESTRO",c.MASTERCARD="MASTERCARD",c.SWITCH="SWITCH",c.VISA="VISA",c))(Qe||{}),Xe=(n=>(n.ICC="ICC",n.NFC="NFC",n.RFID="RFID",n))(Xe||{}),ze=(t=>(t.REQUEST="REQUEST",t.RESPONSE="RESPONSE",t))(ze||{}),Je=(o=>(o.NONE="NONE",o.REQUEST="REQUEST",o.RESPONSE="RESPONSE",o.ACK="ACK",o))(Je||{}),Ze=(o=>(o.ACK_OK="ACK_OK",o.ACK_ERROR="ACK_ERROR",o.ACK_OAUTH_ERROR="ACK_OAUTH_ERROR",o.ACK_PARAMETER="ACK_PARAMETER",o))(Ze||{}),xe=(P=>(P.NOT_APPLICABLE="NOT_APPLICABLE",P.OUT_OF_SERVICE_HOURS="OUT_OF_SERVICE_HOURS",P.OUT_OF_SERVICE_HARDWARE="OUT_OF_SERVICE_HARDWARE",P.OUT_OF_SERVICE_BHS="OUT_OF_SERVICE_BHS",P.OUT_OF_SERVICE_CONSUMABLES="OUT_OF_SERVICE_CONSUMABLES",P.OUT_OF_SERVICE_INTERNAL="OUT_OF_SERVICE_INTERNAL",P.OUT_OF_SERVICE_DCS="OUT_OF_SERVICE_DCS",P.OUT_OF_SERVICE_BACKEND="OUT_OF_SERVICE_BACKEND",P.ABANDONED_BAG="ABANDONED_BAG",P))(xe||{}),we=(c=>(c.INITIALIZE="INITIALIZE",c.UNAVAILABLE="UNAVAILABLE",c.AVAILABLE="AVAILABLE",c.ACTIVE="ACTIVE",c.STOPPED="STOPPED",c.RELOAD="RELOAD",c.SUSPENDED="SUSPENDED",c.DISABLED="DISABLED",c))(we||{}),et=(I=>(I.ASSOCIATE="ASSOCIATE",I.DISASSOCIATE="DISASSOCIATE",I.ENROLL="ENROLL",I.GET_ASSOCIATIONS="GET_ASSOCIATIONS",I.IDENTIFY="IDENTIFY",I.PREVIEW="PREVIEW",I.PURGE="PURGE",I.VERIFY="VERIFY",I.FACE="FACE",I.FINGER="FINGER",I.IRIS="IRIS",I.PALM="PALM",I))(et||{}),g=(a=>(a.DS_TYPES_ISO="DS_TYPES_ISO",a.DS_TYPES_VING="DS_TYPES_VING",a.DS_TYPES_TESSA="DS_TYPES_TESSA",a.DS_TYPES_SAFLOK="DS_TYPES_SAFLOK",a.DS_TYPES_TIMELOX="DS_TYPES_TIMELOX",a.DS_TYPES_KABA_ILCO="DS_TYPES_KABA_ILCO",a.DS_TYPES_KABA_ILCO_FOLIO="DS_TYPES_KABA_ILCO_FOLIO",a.DS_TYPES_IMAGE_IR="DS_TYPES_IMAGE_IR",a.DS_TYPES_IMAGE_VIS="DS_TYPES_IMAGE_VIS",a.DS_TYPES_IMAGE_UV="DS_TYPES_IMAGE_UV",a.DS_TYPES_IMAGE_PHOTO="DS_TYPES_IMAGE_PHOTO",a.DS_TYPES_IMAGE_COAX="DS_TYPES_IMAGE_COAX",a.DS_TYPES_IMAGE_RED="DS_TYPES_IMAGE_RED",a.DS_TYPES_IMAGE_GREEN="DS_TYPES_IMAGE_GREEN",a.DS_TYPES_IMAGE_BLUE="DS_TYPES_IMAGE_BLUE",a.DS_TYPES_IMAGE_GS="DS_TYPES_IMAGE_GS",a.DS_TYPES_IMAGE_BW="DS_TYPES_IMAGE_BW",a.DS_TYPES_IMAGE_BMP="DS_TYPES_IMAGE_BMP",a.DS_TYPES_IMAGE_GIF="DS_TYPES_IMAGE_GIF",a.DS_TYPES_IMAGE_TIF="DS_TYPES_IMAGE_TIF",a.DS_TYPES_IMAGE_PNG="DS_TYPES_IMAGE_PNG",a.DS_TYPES_IMAGE_JPG="DS_TYPES_IMAGE_JPG",a.DS_TYPES_IMAGE_XBM="DS_TYPES_IMAGE_XBM",a.DS_TYPES_IMAGE_XPM="DS_TYPES_IMAGE_XPM",a.DS_TYPES_IMAGE_PPM="DS_TYPES_IMAGE_PPM",a.DS_TYPES_VIDEO_AVI="DS_TYPES_VIDEO_AVI",a.DS_TYPES_VIDEO_MP4="DS_TYPES_VIDEO_MP4",a.DS_TYPES_VIDEO_MOV="DS_TYPES_VIDEO_MOV",a.DS_TYPES_VIDEO_MKV="DS_TYPES_VIDEO_MKV",a.DS_TYPES_VIDEO_WMV="DS_TYPES_VIDEO_WMV",a.DS_TYPES_CODELINE="DS_TYPES_CODELINE",a.DS_TYPES_BARCODE="DS_TYPES_BARCODE",a.DS_TYPES_MIWA="DS_TYPES_MIWA",a.DS_TYPES_SCAN_PDF417="DS_TYPES_SCAN_PDF417",a.DS_TYPES_SCAN_AZTEC="DS_TYPES_SCAN_AZTEC",a.DS_TYPES_SCAN_DMATRIX="DS_TYPES_SCAN_DMATRIX",a.DS_TYPES_SCAN_QR="DS_TYPES_SCAN_QR",a.DS_TYPES_SCAN_CODE39="DS_TYPES_SCAN_CODE39",a.DS_TYPES_SCAN_CODE128="DS_TYPES_SCAN_CODE128",a.DS_TYPES_SCAN_CODE2OF5="DS_TYPES_SCAN_CODE2OF5",a.DS_TYPES_ISO7816="DS_TYPES_ISO7816",a.DS_TYPES_PRINT_2S_PAGE="DS_TYPES_PRINT_2S_PAGE",a.DS_TYPES_PRINT_2S_MULTI="DS_TYPES_PRINT_2S_MULTI",a.DS_TYPES_PRINT_PDF="DS_TYPES_PRINT_PDF",a.DS_TYPES_MIFARE="DS_TYPES_MIFARE",a.DS_TYPES_SUICA="DS_TYPES_SUICA",a.DS_TYPES_ISO15961="DS_TYPES_ISO15961",a.DS_TYPES_RP1745="DS_TYPES_RP1745",a.DS_TYPES_WEIGHT="DS_TYPES_WEIGHT",a.DS_TYPES_DIMENSION="DS_TYPES_DIMENSION",a.DS_TYPES_EPASSPORT_DG1="DS_TYPES_EPASSPORT_DG1",a.DS_TYPES_EPASSPORT_DG2="DS_TYPES_EPASSPORT_DG2",a.DS_TYPES_EPASSPORT_DG3="DS_TYPES_EPASSPORT_DG3",a.DS_TYPES_EPASSPORT_DG4="DS_TYPES_EPASSPORT_DG4",a.DS_TYPES_EPASSPORT_DG5="DS_TYPES_EPASSPORT_DG5",a.DS_TYPES_EPASSPORT_DG6="DS_TYPES_EPASSPORT_DG6",a.DS_TYPES_EPASSPORT_DG7="DS_TYPES_EPASSPORT_DG7",a.DS_TYPES_EPASSPORT_DG8="DS_TYPES_EPASSPORT_DG8",a.DS_TYPES_EPASSPORT_DG9="DS_TYPES_EPASSPORT_DG9",a.DS_TYPES_EPASSPORT_DG10="DS_TYPES_EPASSPORT_DG10",a.DS_TYPES_EPASSPORT_DG11="DS_TYPES_EPASSPORT_DG11",a.DS_TYPES_EPASSPORT_DG12="DS_TYPES_EPASSPORT_DG12",a.DS_TYPES_EPASSPORT_DG13="DS_TYPES_EPASSPORT_DG13",a.DS_TYPES_EPASSPORT_DG14="DS_TYPES_EPASSPORT_DG14",a.DS_TYPES_EPASSPORT_DG15="DS_TYPES_EPASSPORT_DG15",a.DS_TYPES_EPASSPORT_DG16="DS_TYPES_EPASSPORT_DG16",a.DS_TYPES_EPASSPORT_DG17="DS_TYPES_EPASSPORT_DG17",a.DS_TYPES_EPASSPORT_DG18="DS_TYPES_EPASSPORT_DG18",a.DS_TYPES_EPASSPORT_DG19="DS_TYPES_EPASSPORT_DG19",a.DS_TYPES_EPASSPORT_DG20="DS_TYPES_EPASSPORT_DG20",a.DS_TYPES_EPAYMENT="DS_TYPES_EPAYMENT",a.DS_TYPES_ILLUMINATION="DS_TYPES_ILLUMINATION",a.DS_TYPES_SSML="DS_TYPES_SSML",a.DS_TYPES_KEY="DS_TYPES_KEY",a.DS_TYPES_KEY_UP="DS_TYPES_KEY_UP",a.DS_TYPES_KEY_DOWN="DS_TYPES_KEY_DOWN",a.DS_TYPES_BIOMETRIC="DS_TYPES_BIOMETRIC",a.DS_TYPES_PRINT_SVG="DS_TYPES_PRINT_SVG",a.DS_TYPES_ITPS="DS_TYPES_ITPS",a))(g||{}),W=(n=>(n.READY="READY",n.BUSY="BUSY",n.UNAVAILABLE="UNAVAILABLE",n))(W||{}),Ge=(T=>(T.CAPTURE="CAPTURE",T.DISPENSER="DISPENSER",T.FEEDER="FEEDER",T.DATA_INPUT="DATA_INPUT",T.DATA_OUTPUT="DATA_OUTPUT",T.USER_INPUT="USER_INPUT",T.USER_OUTPUT="USER_OUTPUT",T.MEDIA_INPUT="MEDIA_INPUT",T.MEDIA_OUTPUT="MEDIA_OUTPUT",T.STORAGE="STORAGE",T.DISPLAY="DISPLAY",T.NETWORK="NETWORK",T.BAGGAGE_SCALE="BAGGAGE_SCALE",T.INSERTION_BELT="INSERTION_BELT",T.VERIFICATION_BELT="VERIFICATION_BELT",T.PARKING_BELT="PARKING_BELT",T.ANNOUNCEMENT="ANNOUNCEMENT",T.APPLICATION="APPLICATION",T))(Ge||{}),tt=(p=>(p.DS_OK="DS_OK",p.DS_CORRUPTED="DS_CORRUPTED",p.DS_INCOMPLETE="DS_INCOMPLETE",p.DS_ZEROLENGTH="DS_ZEROLENGTH",p.DS_DOCUMENT_AUTHENTICATION_FAILED="DS_DOCUMENT_AUTHENTICATION_FAILED",p.DS_INVALID="DS_INVALID",p.DS_MISMATCH="DS_MISMATCH",p))(tt||{}),Ne=(_=>(_.NON_APPLICABLE_DEVICE_TYPE="NON_APPLICABLE_DEVICE_TYPE",_.PRINT="PRINT",_.READ="READ",_.MOTORIZED="MOTORIZED",_.DIP="DIP",_.SWIPE="SWIPE",_.CONTACTLESS="CONTACTLESS",_.HANDHELD="HANDHELD",_.INSERT="INSERT",_.DISPENSE="DISPENSE",_.CAPTURE="CAPTURE",_.CONVEYOR="CONVEYOR",_.SCALE="SCALE",_.CAMERA="CAMERA",_.FLATBED="FLATBED",_.CHIP_AND_PIN="CHIP_AND_PIN",_.EXTERNAL="EXTERNAL",_.BIOMETRICS="BIOMETRICS",_.ASSISTIVE="ASSISTIVE",_.ILLUMINATION="ILLUMINATION",_.DISPLAY="DISPLAY",_))(Ne||{}),nt=(n=>(n.ALARM="ALARM",n.WARNING="WARNING",n.NORMAL="NORMAL",n))(nt||{}),rt=(t=>(t.SOLICITED="SOLICITED",t.UNSOLICITED="UNSOLICITED",t))(rt||{}),it=(n=>(n.PRIVATE="PRIVATE",n.PUBLIC="PUBLIC",n.PLATFORM="PLATFORM",n))(it||{}),ge=(l=>(l.CARD="CARD",l.CHIP="CHIP",l.BARCODE="BARCODE",l.TICKET="TICKET",l.RECEIPT="RECEIPT",l.BOARDINGPASS="BOARDINGPASS",l.BAGGAGETAG="BAGGAGETAG",l.HEAVYTAG="HEAVYTAG",l.RFID_BAGGAGETAG="RFID_BAGGAGETAG",l.BAGGAGE="BAGGAGE",l.PASSPORT="PASSPORT",l.IDCARD="IDCARD",l.VISA="VISA",l.DRIVERLICENSE="DRIVERLICENSE",l.RFID="RFID",l.NFC="NFC",l.OCR="OCR",l.IMAGE="IMAGE",l.PRINTED="PRINTED",l.AUDIO="AUDIO",l.VISUAL="VISUAL",l.TOUCH="TOUCH",l.DATASTRUCTURE="DATASTRUCTURE",l))(ge||{}),C=(E=>(E.OK="OK",E.CANCELLED="CANCELLED",E.WRONG_SYSTEM_STATE="WRONG_SYSTEM_STATE",E.WRONG_APPLICATION_STATE="WRONG_APPLICATION_STATE",E.OUT_OF_SEQUENCE="OUT_OF_SEQUENCE",E.TIMEOUT="TIMEOUT",E.FORMAT_ERROR="FORMAT_ERROR",E.LENGTH_ERROR="LENGTH_ERROR",E.THRESHOLD_ERROR="THRESHOLD_ERROR",E.THRESHOLD_USAGE="THRESHOLD_USAGE",E.DATA_MISSING="DATA_MISSING",E.DATA_PRESENT="DATA_PRESENT",E.SOFTWARE_ERROR="SOFTWARE_ERROR",E.CRITICAL_SOFTWARE_ERROR="CRITICAL_SOFTWARE_ERROR",E.HARDWARE_ERROR="HARDWARE_ERROR",E.NOT_REACHABLE="NOT_REACHABLE",E.NOT_RESPONDING="NOT_RESPONDING",E.SESSION_TIMEOUT="SESSION_TIMEOUT",E.KILL_TIMEOUT="KILL_TIMEOUT",E.TRANSFER_REQUEST="TRANSFER_REQUEST",E.SYSTEM_REQUEST="SYSTEM_REQUEST",E.SYSTEM_SHUTDOWN="SYSTEM_SHUTDOWN",E.DEVICE_REQUEST="DEVICE_REQUEST",E.MEDIA_JAMMED="MEDIA_JAMMED",E.MEDIA_MISPLACED="MEDIA_MISPLACED",E.MEDIA_PRESENT="MEDIA_PRESENT",E.MEDIA_ABSENT="MEDIA_ABSENT",E.MEDIA_EMPTY="MEDIA_EMPTY",E.MEDIA_DAMAGED="MEDIA_DAMAGED",E.MEDIA_INCOMPLETELY_INSERTED="MEDIA_INCOMPLETELY_INSERTED",E.MEDIA_HIGH="MEDIA_HIGH",E.MEDIA_FULL="MEDIA_FULL",E.MEDIA_LOW="MEDIA_LOW",E.BAGGAGE_FULL="BAGGAGE_FULL",E.BAGGAGE_UNDETECTED="BAGGAGE_UNDETECTED",E.BAGGAGE_PRESENT="BAGGAGE_PRESENT",E.BAGGAGE_ABSENT="BAGGAGE_ABSENT",E.BAGGAGE_OVERSIZED="BAGGAGE_OVERSIZED",E.BAGGAGE_TOO_MANY_BAGS="BAGGAGE_TOO_MANY_BAGS",E.BAGGAGE_UNEXPECTED_BAG="BAGGAGE_UNEXPECTED_BAG",E.BAGGAGE_TOO_HIGH="BAGGAGE_TOO_HIGH",E.BAGGAGE_TOO_LONG="BAGGAGE_TOO_LONG",E.BAGGAGE_TOO_FLAT="BAGGAGE_TOO_FLAT",E.BAGGAGE_TOO_SHORT="BAGGAGE_TOO_SHORT",E.BAGGAGE_TOO_WIDE="BAGGAGE_TOO_WIDE",E.BAGGAGE_TOO_SMALL="BAGGAGE_TOO_SMALL",E.BAGGAGE_INVALID_DATA="BAGGAGE_INVALID_DATA",E.BAGGAGE_WEIGHT_OUT_OF_RANGE="BAGGAGE_WEIGHT_OUT_OF_RANGE",E.BAGGAGE_JAMMED="BAGGAGE_JAMMED",E.BAGGAGE_WRONG_INSERTED="BAGGAGE_WRONG_INSERTED",E.BAGGAGE_EMERGENCY_STOP="BAGGAGE_EMERGENCY_STOP",E.BAGGAGE_RESTLESS="BAGGAGE_RESTLESS",E.BAGGAGE_TRANSPORT_BUSY="BAGGAGE_TRANSPORT_BUSY",E.BAGGAGE_MISTRACKED="BAGGAGE_MISTRACKED",E.BAGGAGE_FORWARD_FAILED="BAGGAGE_FORWARD_FAILED",E.BAGGAGE_BACKWARD_FAILED="BAGGAGE_BACKWARD_FAILED",E.BAGGAGE_UNEXPECTED_CHANGE="BAGGAGE_UNEXPECTED_CHANGE",E.BAGGAGE_ACCEPTED="BAGGAGE_ACCEPTED",E.BAGGAGE_DELIVERED="BAGGAGE_DELIVERED",E.BAGGAGE_INTERFERENCE_USER="BAGGAGE_INTERFERENCE_USER",E.BAGGAGE_INTRUSION_SAFETY="BAGGAGE_INTRUSION_SAFETY",E.BAGGAGE_NOT_CONVEYABLE="BAGGAGE_NOT_CONVEYABLE",E.BAGGAGE_IRREGULAR_BAG="BAGGAGE_IRREGULAR_BAG",E.BAGGAGE_BAG_WITH_STRAPS="BAGGAGE_BAG_WITH_STRAPS",E.BAGGAGE_UPRIGHT_BAG="BAGGAGE_UPRIGHT_BAG",E.BAGGAGE_HANDLE_EXTENDED="BAGGAGE_HANDLE_EXTENDED",E.BAGGAGE_MULTIPLE_BAGS="BAGGAGE_MULTIPLE_BAGS",E.BAGGAGE_SLOPED_BAG="BAGGAGE_SLOPED_BAG",E.BAGGAGE_VOLUME_NOT_DETERMINABLE="BAGGAGE_VOLUME_NOT_DETERMINABLE",E.BAGGAGE_TUB_REQUIRED="BAGGAGE_TUB_REQUIRED",E.BAGGAGE_OVERFLOW_TUB="BAGGAGE_OVERFLOW_TUB",E.BAGGAGE_XRAY_SUSPICIOUS="BAGGAGE_XRAY_SUSPICIOUS",E.BAGGAGE_MAINTENANCE_MODE="BAGGAGE_MAINTENANCE_MODE",E.BAGGAGE_FORCEBAG_MODE="BAGGAGE_FORCEBAG_MODE",E.BAGGAGE_MANUAL_MODE="BAGGAGE_MANUAL_MODE",E.BAGGAGE_OFFBHS_MODE="BAGGAGE_OFFBHS_MODE",E.BAGGAGE_SUSPENDED_MODE="BAGGAGE_SUSPENDED_MODE",E.BAGGAGE_OPERATIONAL_STOP="BAGGAGE_OPERATIONAL_STOP",E))(C||{}),ot=(i=>(i.NON_APPLICABLE_NAVIGATION_TYPE="NON_APPLICABLE_NAVIGATION_TYPE",i.NAVPAD_5_KEY="NAVPAD_5_KEY",i.NAVPAD_8_KEY="NAVPAD_8_KEY",i.AUDIONAV_6_KEY="AUDIONAV_6_KEY",i.AUDIONAV_6_KEY_BAR="AUDIONAV_6_KEY_BAR",i))(ot||{}),st=(f=>(f.DEBIT="DEBIT",f.CREDIT="CREDIT",f.NFC="NFC",f.AMEX="AMEX",f.CART_BLANCHE="CART_BLANCHE",f.DISCOVER="DISCOVER",f.JCB="JCB",f.MAESTRO="MAESTRO",f.MASTERCARD="MASTERCARD",f.SWITCH="SWITCH",f.VISA="VISA",f))(st||{}),K=(S=>(S.PLATFORM_ENVIRONMENT="platform_environment",S.PLATFORM_COMPONENTS="platform_components",S.PLATFORM_APPLICATIONS_STATEREQUEST="platform_applications_staterequest",S.PLATFORM_APPLICATIONS_TRANSFERREQUEST="platform_applications_transferrequest",S.PLATFORM_APPLICATIONS_ACKNOWLEDGE_ACCESSIBLE="platform_applications_acknowledge_accessible",S.PERIPHERALS_ANNOUNCEMENT_PLAY="peripherals_announcement_play",S.PERIPHERALS_ANNOUNCEMENT_PAUSE="peripherals_announcement_pause",S.PERIPHERALS_ANNOUNCEMENT_RESUME="peripherals_announcement_resume",S.PERIPHERALS_ANNOUNCEMENT_STOP="peripherals_announcement_stop",S.PERIPHERALS_CANCEL="peripherals_cancel",S.PERIPHERALS_QUERY="peripherals_query",S.PERIPHERALS_SEND="peripherals_send",S.PERIPHERALS_SETUP="peripherals_setup",S.PERIPHERALS_USERPRESENT_ENABLE="peripherals_userpresent_enable",S.PERIPHERALS_USERPRESENT_DISABLE="peripherals_userpresent_disable",S.PERIPHERALS_USERPRESENT_OFFER="peripherals_userpresent_offer",S.PERIPHERALS_CONVEYORS_FORWARD="peripherals_conveyors_forward",S.PERIPHERALS_CONVEYORS_BACKWARD="peripherals_conveyors_backward",S.PERIPHERALS_CONVEYORS_PROCESS="peripherals_conveyors_process",S))(K||{}),at=(h=>(h.CLR_RGB="CLR_RGB",h.CLR_ON="CLR_ON",h.CLR_OFF="CLR_OFF",h.CLR_RED="CLR_RED",h.CLR_GREEN="CLR_GREEN",h.CLR_BLUE="CLR_BLUE",h.CLR_DARKRED="CLR_DARKRED",h.CLR_DARKGREEN="CLR_DARKGREEN",h.CLR_DARKBLUE="CLR_DARKBLUE",h.CLR_YELLOW="CLR_YELLOW",h.CLR_MAGENTA="CLR_MAGENTA",h.CLR_CYAN="CLR_CYAN",h.CLR_AMBER="CLR_AMBER",h.CLR_PURPLE="CLR_PURPLE",h.CLR_SPRINGGREEN="CLR_SPRINGGREEN",h.CLR_WHITE="CLR_WHITE",h))(at||{});var Tt=ye(X());var be=class{action;data;level;constructor(e,t,n){this.action=t,this.level=e,this.data=n}},Rt=new Tt.EventEmitter,R=(r,e,t)=>{Rt.emit("log",new be(r,e,t))},L={splitAndFilter:(r,e="#")=>r.split(e).filter(t=>!!t),split_every:(r,e)=>r?r.match(new RegExp(".{1,"+e+"}","g")):[],deserializeDictionary:(r,e="#",t="=")=>{let n={};return L.splitAndFilter(r,e).forEach(o=>{let[i,s]=o.split(t);s&&i&&(n[i]=s)}),n},isNonCritical:r=>!Vt.some(e=>e===r)},Vt=["CANCELLED","WRONG_APPLICATION_STATE","OUT_OF_SEQUENCE","TIMEOUT","SESSION_TIMEOUT","KILL_TIMEOUT","SOFTWARE_ERROR","CRITICAL_SOFTWARE_ERROR","FORMAT_ERROR","LENGTH_ERROR","DATA_MISSING","THRESHOLD_ERROR","THRESHOLD_USAGE","HARDWARE_ERROR","NOT_REACHABLE","NOT_RESPONDING","BAGGAGE_FULL","BAGGAGE_UNDETECTED","BAGGAGE_OVERSIZED","BAGGAGE_TOO_MANY_BAGS","BAGGAGE_UNEXPECTED_BAG","BAGGAGE_TOO_HIGH","BAGGAGE_TOO_LONG","BAGGAGE_TOO_FLAT","BAGGAGE_TOO_SHORT","BAGGAGE_INVALID_DATA","BAGGAGE_WEIGHT_OUT_OF_RANGE","BAGGAGE_JAMMED","BAGGAGE_EMERGENCY_STOP","BAGGAGE_RESTLESS","BAGGAGE_TRANSPORT_BUSY","BAGGAGE_MISTRACKED","BAGGAGE_UNEXPECTED_CHANGE","BAGGAGE_INTERFERENCE_USER","BAGGAGE_INTRUSION_SAFETY","BAGGAGE_NOT_CONVEYABLE","BAGGAGE_IRREGULAR_BAG","BAGGAGE_VOLUME_NOT_DETERMINABLE","BAGGAGE_OVERFLOW_TUB"],Ht=r=>Array.isArray(r)&&r.length>0&&"data"in r[0],D={applicationData:(r,e={})=>{let{componentID:t,deviceID:n="00000000-0000-0000-0000-000000000000",dataObj:o}=e,i={};i.requestID=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).substring(2,15)}-${Math.random().toString(36).substring(2,15)}`,i.directive=r,t!==void 0&&(i.componentID=t),i.deviceID=n;let s={};return o&&"applicationStateCode"in o&&(s.applicationState=o),o&&"targetApplicationID"in o&&(s.applicationTransfer=o),Ht(o)&&(s.dataRecords=o),o&&"vertical"in o&&(s.screenResolution=o),o&&"lightColor"in o&&(s.illuminationData=o),o&&"baggageMeasurements"in o&&(s.bagdropData=o),o&&"ePaymentMessage"in o&&(s.paymentData=o),o&&"biometricProviderMessage"in o&&(s.biometricData=o),{meta:i,payload:s}},stateChange:(r,e,t,n=void 0)=>D.applicationData("platform_applications_staterequest",{dataObj:{applicationStateCode:r,applicationStateChangeReasonCode:e,applicationStateChangeReason:t,applicationBrand:n}})};var Pt=ye(X()),j=class r extends Pt.EventEmitter{waitFor(e,t=["error"]){return new Promise((n,o)=>{let i=[],s=()=>{for(let u of i)u.source.off(u.event,u.handler)},p=u=>{s(),n(u)},c=u=>{s(),o(u)},P=(u,f)=>{let I=u.indexOf(".");if(I>0){let yt=u.substring(0,I),We=u.substring(I+1),Ce=this[yt];if(Ce&&Ce instanceof r){Ce.once(We,f),i.push({source:Ce,event:We,handler:f});return}}this.once(u,f),i.push({source:this,event:u,handler:f})};P(e,p);for(let u of t)P(u,c)})}};var Dt=ye(X());var m={UNKNOWN:"UNKNOWN",BAG_TAG_PRINTER:"BAG_TAG_PRINTER",BAG_TAG_FEEDER:"BAG_TAG_FEEDER",BAG_TAG_DISPENSER:"BAG_TAG_DISPENSER",BOARDING_PASS_PRINTER:"BOARDING_PASS_PRINTER",BOARDING_PASS_FEEDER:"BOARDING_PASS_FEEDER",BOARDING_PASS_DISPENSER:"BOARDING_PASS_DISPENSER",BARCODE_READER:"BARCODE_READER",PASSPORT_READER:"PASSPORT_READER",MSR_READER:"MSR_READER",KEY_PAD:"KEY_PAD",ANNOUNCEMENT:"ANNOUNCEMENT",FEEDER:"FEEDER",DISPENSER:"DISPENSER",ILLUMINATION:"ILLUMINATION",HEADSET:"HEADSET",BIOMETRIC:"BIOMETRIC",SCALE:"SCALE",CAMERA:"CAMERA",INSERTION_BELT:"INSERTION_BELT",VERIFICATION_BELT:"VERIFICATION_BELT",PARKING_BELT:"PARKING_BELT",RFID:"RFID",AEASBD:"AEASBD",BHS:"BHS"};var $=class extends Dt.EventEmitter{_component;id;api;required=!1;_status="OK";_componentState="UNAVAILABLE";deviceType;pendingCalls=0;enabled=!1;pollingInterval=1e4;_poller;parent;subcomponents=[];get ready(){return this._componentState==="READY"}get pending(){return this.pendingCalls>0}get status(){return this._status}constructor(e,t,n=m.UNKNOWN){if(super(),this._component=e,this.id=Number(e.componentID),this.deviceType=n,this.parent=null,Object.defineProperty(this,"api",{get:()=>t.api,enumerable:!1}),t.on("message",o=>{o?.meta?.componentID===this.id&&this.handleMessage(o)}),t.on("deactivated",()=>{this.enabled=!1}),e.linkedComponentIDs?.length){let o=this.deviceType,i=Math.min(this.id,...e.linkedComponentIDs);i!==this.id&&(this.parent=t.components?.[i],this.parent&&(this.parent.subcomponents.push(this),this.parent[o]=this))}}stateIsDifferent(e){return this.status!==e.meta.messageCode||this._componentState!==e.meta.componentState}updateState(e){let{meta:t}=e;t.componentState!==this._componentState&&(this._componentState=t.componentState??"UNAVAILABLE",t.componentState!=="READY"&&(this.enabled=!1),this.emit("readyStateChange",t.componentState==="READY")),!this.ready&&this.required&&!this._poller&&this.pollingInterval>0&&this.pollUntilReady(),this.status!==t.messageCode&&(this._status=t.messageCode,this.emit("statusChange",t.messageCode))}pollUntilReady(e=!1,t=this.pollingInterval){if(this._poller)return;let n=()=>{if(this.ready&&(!e||this.status==="OK"))return this._poller=void 0;this._poller=setTimeout(()=>{this.query().catch(Object).finally(n)},t)};n()}handleMessage(e){this.emit("message",e)}async _call(e){this.pendingCalls++;try{return await e()}catch(t){return await Promise.reject(t)}finally{this.pendingCalls--}}async enable(){let e=await this._call(()=>this.api.enable(this.id));return this.enabled=!0,e}async disable(){try{let e=await this._call(()=>this.api.disable(this.id));return this.enabled=!1,e}catch(e){let t=e;return t.meta.messageCode==="OUT_OF_SEQUENCE"?(this.enabled=!1,t):Promise.reject(e)}}async cancel(){return await this._call(()=>this.api.cancel(this.id))}async query(){return await this._call(()=>this.api.getStatus(this.id))}async setup(e){return await this._call(()=>this.api.setup(this.id,e))}async send(e){return await this._call(()=>this.api.send(this.id,e))}};var ft=ye(X());var O=class extends ft.EventEmitter{_component;id;api;required=!1;_status="OK";_componentState="UNAVAILABLE";deviceType;pendingCalls=0;pollingInterval=1e4;_poller;parent;subcomponents=[];get ready(){return this._componentState==="READY"}get pending(){return this.pendingCalls>0}get status(){return this._status}get componentState(){return this._componentState}constructor(e,t,n=m.UNKNOWN){super(),this.deviceType=n,this._component=e,this.id=Number(e.componentID),this.api=t.api,this.parent=null;let o=e.componentCharacteristics?.[0];this.required=o?.required||!1,this._componentState="UNAVAILABLE",this._status="OK",this.setupEventListeners(t)}setupEventListeners(e){e.on("message",t=>{t?.meta?.componentID===this.id&&(this.handleMessage(t),this.updateState(t))}),e.on("deactivated",()=>{})}handleMessage(e){this.emit("message",e)}stateIsDifferent(e){return this.status!==e.meta.messageCode||this._componentState!==e.meta.componentState}updateState(e){e?.meta?.componentState&&(this._componentState=e.meta.componentState,this.emit("readyStateChange",this._componentState)),e?.meta?.messageCode&&(this._status=e.meta.messageCode,this.emit("statusChange",this._status))}async query(){return this.pendingCalls++,await this.api.getStatus(this.id).finally(()=>this.pendingCalls--)}async cancel(){return this.pendingCalls++,await this.api.cancel(this.id).finally(()=>this.pendingCalls--)}async setup(e){this.pendingCalls++;let t=await this.api.setup(this.id,e).finally(()=>this.pendingCalls--);return this.updateState(t),t}startPolling(){this._poller||(this._poller=setInterval(async()=>{await this.query()},this.pollingInterval))}stopPolling(){this._poller&&(clearInterval(this._poller),this._poller=void 0)}pollUntilReady(e=!1,t=this.pollingInterval){if(this._poller)return;let n=()=>{if(this.ready&&(!e||this.status==="OK")){this._poller=void 0;return}this._poller=setTimeout(()=>{this.query().catch(Object).finally(n)},t)};n()}};var d=class extends O{enabled=!1;async enable(){this.pendingCalls++;let e=await this.api.enable(this.id).finally(()=>this.pendingCalls--);return this.updateState(e),this.enabled=!0,e}async disable(){this.pendingCalls++;let e=await this.api.disable(this.id).finally(()=>this.pendingCalls--);return this.updateState(e),this.enabled=!1,e}};var z=class extends O{previousData=[];handleMessage(e){super.handleMessage(e),e?.meta?.messageCode==="DATA_PRESENT"&&e?.payload?.dataRecords?.length&&(this.previousData=e?.payload?.dataRecords?.map(t=>t?.data||""),this.emit("data",this.previousData))}read(e=3e4){return new Promise((t,n)=>{let o=setTimeout(()=>{this.off("data",i),n(new Error(`Timeout of ${e}ms exceeded`))},e),i=s=>{clearTimeout(o),t(s)};this.once("data",i)})}};var J=class extends O{async send(e){this.pendingCalls++;let t=await this.api.send(this.id,e).finally(()=>this.pendingCalls--);return this.updateState(t),t}};var Z=class extends d{};var v=class extends d{async send(e){this.pendingCalls++;let t=await this.api.send(this.id,e).finally(()=>this.pendingCalls--);return this.updateState(t),t}};var y=class extends d{previousData=[];handleMessage(e){super.handleMessage(e),e?.meta?.messageCode==="DATA_PRESENT"&&e?.payload?.dataRecords?.length&&(this.previousData=e?.payload?.dataRecords?.map(t=>t?.data||""),this.emit("data",this.previousData))}async read(e=3e4){return await this.enable(),new Promise((t,n)=>{let o=setTimeout(()=>{this.off("data",i),n(new Error(`Timeout of ${e}ms exceeded`))},e),i=s=>{clearTimeout(o),t(s)};this.once("data",i)}).finally(()=>this.disable())}};var b=class extends d{async send(e){this.pendingCalls++;let t=await this.api.send(this.id,e).finally(()=>this.pendingCalls--);return this.updateState(t),t}};var ee=class extends d{previousData=[];handleMessage(e){super.handleMessage(e),e?.meta?.messageCode==="DATA_PRESENT"&&e?.payload?.dataRecords?.length&&(this.previousData=e?.payload?.dataRecords?.map(t=>t?.data||""),this.emit("data",this.previousData))}async read(e=3e4){return await this.enable(),new Promise((t,n)=>{let o=setTimeout(()=>{this.off("data",i),n(new Error(`Timeout of ${e}ms exceeded`))},e),i=s=>{clearTimeout(o),t(s)};this.once("data",i)}).finally(()=>this.disable())}};var te=class extends d{async play(e){return this.pendingCalls++,await this.api.announcement.play(this.id,e).finally(()=>this.pendingCalls--)}async pause(){return this.pendingCalls++,await this.api.announcement.pause(this.id).finally(()=>this.pendingCalls--)}async resume(){return this.pendingCalls++,await this.api.announcement.resume(this.id).finally(()=>this.pendingCalls--)}async stop(){return this.pendingCalls++,await this.api.announcement.stop(this.id).finally(()=>this.pendingCalls--)}say(e,t="en-US"){let n=`<?xml version="1.0" encoding="UTF-8"?>
      <speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis"
             xml:lang="${t}">${e}</speak>`;return this.play(n)}};var B=class extends O{async send(e){this.pendingCalls++;let t=await this.api.send(this.id,e).finally(()=>this.pendingCalls--);return this.updateState(t),t}forward(){return Promise.reject(new Error("Conveyor forward operation not yet implemented"))}backward(){return Promise.reject(new Error("Conveyor backward operation not yet implemented"))}process(){return Promise.reject(new Error("Conveyor process operation not yet implemented"))}};var ne=class extends d{async send(e){this.pendingCalls++;let t=await this.api.send(this.id,e).finally(()=>this.pendingCalls--);return this.updateState(t),t}async offer(){return this.pendingCalls++,await this.api.offer(this.id).finally(()=>this.pendingCalls--)}forward(){return Promise.reject(new Error("Conveyor forward operation not yet implemented"))}backward(){return Promise.reject(new Error("Conveyor backward operation not yet implemented"))}process(){return Promise.reject(new Error("Conveyor process operation not yet implemented"))}};var re=class extends d{_mediaPresent=!1;get mediaPresent(){return this._mediaPresent}set mediaPresent(e){this._mediaPresent=e}handleMessage(e){super.handleMessage(e),e?.meta?.messageCode==="MEDIA_PRESENT"?(this._mediaPresent=!0,this.emit("mediaPresent",!0)):e?.meta?.messageCode==="MEDIA_EMPTY"&&(this._mediaPresent=!1,this.emit("mediaPresent",!1))}async offer(){this.pendingCalls++;let e=await this.api.offer(this.id).finally(()=>this.pendingCalls--);return e?.meta?.messageCode==="OK"&&(this._mediaPresent=!1),e}};var ie=class extends O{async offer(){return this.pendingCalls++,await this.api.offer(this.id).finally(()=>this.pendingCalls--)}};var oe=class extends y{constructor(e,t){super(e,t,m.BARCODE_READER)}};var se=class extends y{constructor(e,t){super(e,t,m.PASSPORT_READER)}};var ae=class extends y{constructor(e,t){super(e,t,m.MSR_READER)}async enablePayment(e){await this.setup([{data:"",dsTypes:[e?"DS_TYPES_PAYMENT_ISO":"DS_TYPES_ISO"]}])}async readPayment(e=3e4){await this.enablePayment(!0),await this.read(e),await this.enablePayment(!1)}};var pe=class extends ee{constructor(e,t){super(e,t,m.SCALE)}};var Ee=class extends y{constructor(e,t){super(e,t,m.RFID)}};var me=class extends y{constructor(e,t){super(e,t,m.CAMERA)}};var ce=class extends b{constructor(e,t){super(e,t,m.AEASBD)}};var Ae=class extends z{constructor(e,t){super(e,t,m.BHS)}};var U=class extends ie{printer;constructor(e,t){super(e,t,m.FEEDER)}};var M=class extends re{printer;constructor(e,t){super(e,t,m.DISPENSER),this.on("statusChange",n=>{n==="MEDIA_PRESENT"?(this.pollUntilReady(!0,2e3),this.mediaPresent||(this.mediaPresent=!0,this.emit("mediaPresent",!0))):this.mediaPresent&&(this.mediaPresent=!1,this.emit("mediaPresent",!1))})}};var x=class extends Error{constructor(e){super("Platform returned status code: "+e.meta.messageCode),this.componentID=e.meta.componentID,this.componentState=e.meta.componentState,this.requestID=e.meta.requestID,this.messageCode=e.meta.messageCode||"SOFTWARE_ERROR"}componentID;componentState;requestID;messageCode};var w=class extends b{constructor(e,t,n){super(e,t,n);let o=p=>{throw new Error(p)},i=e.linkedComponentIDs?.map(p=>t.components?.[p])||[];this.feeder=i.find(p=>p instanceof U)||o("Feeder not found for Printer "+this.id),this.subcomponents.push(this.feeder);let s=i.find(p=>p instanceof M);this.dispenser=s||o("Dispenser not found for Printer "+this.id),this.subcomponents.push(this.dispenser)}feeder;dispenser;get mediaPresent(){return this.dispenser.mediaPresent}updateState(e){e.meta.platformDirective==="peripherals_send"&&e.meta.messageCode==="TIMEOUT"&&e.meta.componentState==="UNAVAILABLE"&&(e.meta.componentState="READY"),!this.ready&&e.meta.componentState==="READY"?(this.feeder.query().catch(console.error),this.dispenser.query().catch(console.error)):e.meta.messageCode==="MEDIA_PRESENT"&&(this.dispenser.emit("mediaPresent",!0),this.dispenser.query().catch(console.error)),super.updateState(e)}async setupITPS(e){let t=e.map(n=>({data:n,dsTypes:["DS_TYPES_ITPS"]}));return await this.api.setup(this.id,t)}async sendITPS(e){let t=e.map(n=>({data:n,dsTypes:["DS_TYPES_ITPS"]}));return await this.api.send(this.id,t)}async sendITPSCommand(e){let t=await this.setupITPS([e]),n=t.payload;if(!n||n.length===0)throw new x(t);return n[0].data||""}async getEnvironment(){let e=await this.sendITPSCommand("ES");return L.deserializeDictionary(e)}async getPairedResponse(e,t=2){let n=await this.sendITPSCommand(e);return L.split_every(n.substr(n.indexOf("OK")+2),t)||[]}logos={clear:async(e="")=>{let t=await this.sendITPSCommand("LC"+e);return!!t&&t.indexOf("OK")>-1},query:async()=>await this.getPairedResponse("LS")};pectabs={clear:async(e="")=>{let t=await this.sendITPSCommand("PC"+e);return!!t&&t.indexOf("OK")>-1},query:async()=>await this.getPairedResponse("PS")}};var le=class extends w{constructor(e,t){super(e,t,m.BAG_TAG_PRINTER)}pectabs={clear:async(e="")=>{let t=await this.sendITPSCommand("PC"+e);return!!t&&t.indexOf("OK")>-1},query:async()=>await this.getPairedResponse("PS",4)}};var _e=class extends w{constructor(e,t){super(e,t,m.BOARDING_PASS_PRINTER)}templates={clear:async(e="")=>{let t=await this.sendITPSCommand("TC"+e);return!!t&&t.indexOf("OK")>-1},query:async()=>await this.getPairedResponse("TA")}};var ue=class extends Z{constructor(e,t){super(e,t,m.KEY_PAD)}handleMessage(e){if(super.handleMessage(e),e.meta.componentID!==this.id)return;let t=e.payload?.dataRecords;if(t?.length){let n=t.map(i=>i.data),o={UP:n.includes("NAVUP"),DOWN:n.includes("NAVDOWN"),PREVIOUS:n.includes("NAVPREVIOUS"),NEXT:n.includes("NAVNEXT"),ENTER:n.includes("NAVENTER"),HOME:n.includes("NAVHOME"),END:n.includes("NAVEND"),HELP:n.includes("NAVHELP"),VOLUMEUP:n.includes("VOLUMEUP"),VOLUMEDOWN:n.includes("VOLUMEDOWN")};this.emit("keypadData",o)}}};var Se=class extends te{constructor(e,t){super(e,t,m.ANNOUNCEMENT)}};var It=(i=>(i.Red="red",i.Green="green",i.Blue="blue",i.Yellow="yellow",i.White="white",i))(It||{}),de=class extends J{constructor(e,t){super(e,t,m.ILLUMINATION)}async illuminate(e=0,t,n){let o=typeof t=="string"&&It[t]||void 0,i=Array.isArray(t)&&t.length===3?{red:t[0],green:t[1],blue:t[2]}:void 0,s=Array.isArray(n)&&n.length===2?{durationOn:n[0],durationOff:n[1]}:void 0,c=[{data:JSON.stringify({duration:e,lightColor:{name:o,rgb:i},blinkRate:s}),dsTypes:["DS_TYPES_DATASTRUCTURE"]}];return await this.send(c)}async turnOff(){return await this.illuminate(0)}};var Te=class extends v{constructor(e,t){super(e,t,m.HEADSET)}};var Re=class extends v{constructor(e,t){super(e,t,m.BIOMETRIC)}};var Pe=class extends ne{constructor(e,t){super(e,t,m.INSERTION_BELT)}};var De=class extends B{constructor(e,t){super(e,t,m.VERIFICATION_BELT)}};var fe=class extends B{constructor(e,t){super(e,t,m.PARKING_BELT)}};var Ve=class extends Error{constructor(e){super(e),this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor)}},Ie=class extends Ve{status;constructor(e,t=401){super(e),this.status=t}};function ht(r,e,t,n,o){let i=Math.min(r,e*n**t);return(1-o*Math.random())*i}var He=class extends Error{constructor(e,t){super(`Retrying exceeded the maxAttempts (${t}).`),this.name="RetryError",this.cause=e}};async function ke(r,e){let{multiplier:t=2,maxTimeout:n=6e4,maxAttempts:o=5,minTimeout:i=1e3,jitter:s=1}=e??{};if(n<=0)throw new TypeError(`Cannot retry as 'maxTimeout' must be positive: current value is ${n}`);if(i>n)throw new TypeError(`Cannot retry as 'minTimeout' must be <= 'maxTimeout': current values 'minTimeout=${i}', 'maxTimeout=${n}'`);if(s>1)throw new TypeError(`Cannot retry as 'jitter' must be <= 1: current value is ${s}`);let p=0;for(;;){try{return await r()}catch(c){if(p+1>=o)throw new He(c,o);let P=ht(n,i,p,t,s);await new Promise(u=>setTimeout(u,P))}p++}}var G=(...r)=>{},he={get WebSocket(){return globalThis.WebSocket},fetch:globalThis.fetch.bind(globalThis),clearTimeout:globalThis.clearTimeout.bind(globalThis),setTimeout:globalThis.setTimeout.bind(globalThis)},Be=class r extends j{_auth;_baseURL;_socketURL;_socket;_refresher=null;deviceID;access_token="";_retryOptions;get isOpen(){return!!this._socket&&this._socket.readyState===1}constructor(e,t,n,o,i,s){super(),this.deviceID=o,this.setMaxListeners(0),this._validateURL(e,"Base URL"),i&&this._validateURL(i,"Token URL"),this._baseURL=this._cleanBaseURL(e);let p=i?this._convertToHttpProtocol(i):`${this._convertToHttpProtocol(this._baseURL)}/oauth/token`;this._auth={url:p,client_id:t,client_secret:n},this._socketURL=this._buildWebSocketURL(this._baseURL),this._retryOptions={maxAttempts:99,minTimeout:1e3,maxTimeout:64e3,multiplier:2,jitter:.25,...s}}async authorize(){G("info",`Authorizing client '${this._auth.client_id}'`,this._auth.url);let e=new URLSearchParams;e.append("client_id",this._auth.client_id),e.append("client_secret",this._auth.client_secret),e.append("grant_type","client_credentials");let t=0,n=await ke(async()=>{G("info",`Retrying client '${this._auth.client_id}'`),this.emit("authenticating",++t);let o=await he.fetch(this._auth.url,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},redirect:"follow",body:e.toString()});if(o.status===401)return new Ie("Invalid Credentials",401);if(o.status>=400)throw new Error(`HTTP error! status: ${o.status}`);let i=await o.json(),s={access_token:i.access_token,expires_in:i.expires_in,token_type:i.token_type};return this.emit("authenticated",s),s},this._retryOptions);if(n instanceof Ie)throw this.emit("authenticationError",n),n;return t=0,n}static connect(e,t,n,o,i,s){using p=new r(e,t,n,o,i,s);return p.once("authenticated",()=>p._createWebSocketAndAttachEventHandlers()),setTimeout(()=>p._authenticateAndQueueTokenRefresh(),10),p}_validateURL(e,t){let n=["http:","https:","ws:","wss:"];try{let o=new URL(e);if(!n.includes(o.protocol))throw new Error(`${t} uses unsupported protocol '${o.protocol}'. Only ${n.map(i=>i.replace(":","://")).join(", ")} are supported.`)}catch(o){throw o instanceof TypeError?new Error(`${t} is not a valid URL: ${e}`):o}}_cleanBaseURL(e){try{return new URL(e).origin}catch{let n=e.split("?")[0];return n.endsWith("/")?n.slice(0,-1):n}}_convertToHttpProtocol(e){return e.startsWith("ws://")?e.replace(/^ws:/,"http:"):e.startsWith("wss://")?e.replace(/^wss:/,"https:"):e}_buildWebSocketURL(e){if(e.startsWith("ws://")||e.startsWith("wss://"))return`${e}/platform/subscribe`;if(e.startsWith("https://"))return`wss://${e.replace(/^https:\/\//,"")}/platform/subscribe`;if(e.startsWith("http://"))return`ws://${e.replace(/^http:\/\//,"")}/platform/subscribe`;throw new Error(`Unable to build WebSocket URL from base URL: ${e}`)}async _authenticateAndQueueTokenRefresh(){G("info","Getting access_token"),this._refresher&&(he.clearTimeout(this._refresher),this._refresher=null);try{let e=await this.authorize();this.access_token=e.access_token;let t=Math.max(0,e.expires_in);t>0&&(G("info",`access_token expires in ${t} seconds`),this._refresher=he.setTimeout(()=>this._authenticateAndQueueTokenRefresh(),(t-1)*1e3))}catch(e){G("error","Authentication failed:",e)}}_createWebSocketAndAttachEventHandlers(){let e=0;ke(()=>new Promise((t,n)=>{if(this.isOpen)return t(!0);this.emit("connecting",++e);let o;typeof Deno<"u"&&(o={headers:{Origin:this._baseURL.startsWith("http")?this._baseURL:`http://${this._baseURL}`}});let i=new he.WebSocket(this._socketURL,void 0,o);i.onopen=()=>{G("info","Socket opened: ",this._socketURL),this._socket=i,e=0,t(!0),this.emit("open")},i.onmessage=s=>{try{let p=JSON.parse(s.data);if(p.ping){i.send(`{ "pong": ${Date.now()} }`),this.emit("ping",p);return}if(p.ackCode){this.emit("ack",p);return}G("socket.onmessage",s);let c=p;this.emit("message",c),c?.meta?.requestID&&this.emit(String(c.meta.requestID),c)}catch(p){G("error","Error processing message:",p),this.emit("messageError",p)}},i.onclose=s=>{G("Websocket Close:",s.reason),i.onopen=null,i.onclose=null,i.onerror=null,i.onmessage=null,this.emit("close",s),s.code!==1e3&&e>0&&n(s)},i.onerror=s=>{G("Websocket Error:",s),this.emit("socketError",s)}}),this._retryOptions)}send(e){if(!this.isOpen)throw new Error("WebSocket connection not established");e instanceof Object&&!e.meta?.oauthToken&&(e.meta.oauthToken=this.access_token),e instanceof Object&&!e.meta?.deviceID&&(e.meta.deviceID=this.deviceID),this.json(e)}json(e){this._socket?.send(JSON.stringify(e))}async sendAndGetResponse(e){if(!this.isOpen)throw new Error("WebSocket connection not established");let t=e.meta,n=t.requestID;t.oauthToken=this.access_token,(t.deviceID===null||t.deviceID==="00000000-0000-0000-0000-000000000000")&&this.deviceID!==null&&(t.deviceID=this.deviceID);let o=this.waitFor(n,["messageError","socketError","close"]);this._socket?.send(JSON.stringify(e));let i=await o,s=i.meta?.messageCode;if(s&&L.isNonCritical(s))return i;throw new x(i)}close(e,t){this._refresher&&(he.clearTimeout(this._refresher),this._refresher=null),this._socket?.close(e,t)}[Symbol.dispose](){this._refresher&&clearTimeout(this._refresher)}};var Q=class{previous;current;constructor(e,t){this.previous=e,this.current=t}};var Y=ge,F=g;var V=(r,e)=>r?.dsTypesList?.find(t=>t===e),H=(r,e)=>r?.find(t=>t===e),k=(r,e)=>r?.find(t=>t===e),Ue=class{static isAnnouncement=e=>e.componentType==="ANNOUNCEMENT";static isFeeder=e=>e.componentType==="FEEDER";static isDispenser=e=>e.componentType==="DISPENSER";static isBagTagPrinter=e=>{let t=e.componentCharacteristics?.[0];if(!t)return;let n=t.mediaTypesList;return k(t.deviceTypesList,"PRINT")&&H(n,Y.BAGGAGETAG)};static isBoardingPassPrinter=e=>{let t=e.componentCharacteristics?.[0];if(!t)return;let n=t.mediaTypesList;return k(t.deviceTypesList,"PRINT")&&H(n,Y.BOARDINGPASS)};static isDocumentReader=e=>{let t=e.componentCharacteristics?.[0];if(!t)return;let n=t.mediaTypesList;return H(n,Y.PASSPORT)};static isBarcodeReader=e=>{let t=e.componentCharacteristics?.[0];if(t)return V(t,F.DS_TYPES_BARCODE)};static isCardReader=e=>{let t=e.componentCharacteristics?.[0];if(!t)return;let n=t.mediaTypesList;return H(n,"MAGCARD")};static isKeypad=e=>{let t=e.componentCharacteristics?.[0];if(t)return V(t,F.DS_TYPES_KEY)||V(t,F.DS_TYPES_KEY_UP)||V(t,F.DS_TYPES_KEY_DOWN)};static isIllumination=e=>{let t=e.componentCharacteristics?.[0];if(t)return k(t.deviceTypesList,"ILLUMINATION")};static isHeadset=e=>{if(e.componentType!=="USER_INPUT")return;let t=e.componentCharacteristics?.[0];if(!t)return;let n=t.mediaTypesList;return k(t.deviceTypesList,"ASSISTIVE")&&H(n,Y.AUDIO)};static isScale=e=>{if(e.componentType!=="DATA_INPUT")return;let t=e.componentCharacteristics?.[0];if(t)return k(t.deviceTypesList,"SCALE")};static isBiometric=e=>{let t=e.componentCharacteristics?.[0];if(t)return V(t,F.DS_TYPES_BIOMETRIC)};static isCamera=e=>{if(e.componentType!=="DATA_INPUT")return;let t=e.componentCharacteristics?.[0];if(!t)return;let n=t.mediaTypesList;return k(t.deviceTypesList,"CAMERA")&&H(n,Y.IMAGE)};static isRFIDReader=e=>{if(e.componentType!=="DATA_INPUT")return!1;let t=e.componentCharacteristics?.[0];if(!t)return!1;let n=t.mediaTypesList;return!!k(t.deviceTypesList,"CONTACTLESS")&&!!H(n,Y.RFID)};static isInsertionBelt=e=>e.componentCharacteristics?.[0]?e.componentType==="INSERTION_BELT":!1;static isVerificationBelt=e=>e.componentCharacteristics?.[0]?e.componentType==="VERIFICATION_BELT":!1;static isParkingBelt=e=>e.componentCharacteristics?.[0]?e.componentType==="PARKING_BELT":!1;static isAEASBD=e=>{if(e.componentType!=="USER_OUTPUT")return!1;let t=e.componentCharacteristics?.[0];return t?!!V(t,"SBDAEA"):!1};static isBHS=e=>{if(e.componentType!=="DATA_OUTPUT")return!1;let t=e.componentCharacteristics?.[0];return t?!!V(t,F.DS_TYPES_RP1745):!1}};var{isAnnouncement:kt,isFeeder:Ct,isDispenser:Ot,isBagTagPrinter:Wt,isBoardingPassPrinter:Kt,isDocumentReader:qt,isBarcodeReader:jt,isCardReader:$t,isBiometric:Qt,isKeypad:Xt,isIllumination:zt,isHeadset:Jt,isScale:Zt,isCamera:en,isInsertionBelt:tn,isParkingBelt:nn,isRFIDReader:rn,isVerificationBelt:on,isAEASBD:sn,isBHS:an}=Ue;function N(r){if(typeof r!="number")throw new TypeError("Invalid componentID: "+r)}var Me=class r extends j{connection;environment={};components=void 0;_currentState=new Q("STOPPED","STOPPED");bagTagPrinter;boardingPassPrinter;documentReader;barcodeReader;illumination;announcement;keypad;cardReader;biometric;scale;insertionBelt;verificationBelt;parkingBelt;rfid;headset;camera;bhs;aeasbd;pendingStateChange;multiTenant;accessibleMode=!1;language;get state(){return this._currentState.current}get connected(){return this.connection.isOpen&&this.components?Promise.resolve():this.waitFor("connected",["connection.authenticationError","connection.close"])}constructor(e){super(),this.connection=e,this.setMaxListeners(100),e.on("message",t=>this._handleWebSocketMessage(t)),e.on("open",()=>this._initialize().catch(t=>{R("error","Initialization failed",t),e.emit("error",new Error("Initialization failed: "+t.message))}))}static connect(e,t,n="https://localhost:22222",o="00000000-0000-0000-0000-000000000000",i){using s=Be.connect(n,e,t,o,i);return new r(s)}_ensureConnected(){if(!this.connection.isOpen)throw new Error("Connection not established. Please await cuss2.connected before making API calls.")}async _initialize(){R("info","Getting Environment Information");let e=await this.api.getEnvironment(),t=this.connection.deviceID;if((t==="00000000-0000-0000-0000-000000000000"||t===null)&&(this.connection.deviceID=e.deviceID),!this.state)throw new Error("Platform in abnormal state.");if(this.state==="SUSPENDED"||this.state==="DISABLED")throw new Error(`Platform has ${this.state} the application`);R("info","Getting Component List"),await this.api.getComponents(),await this.queryComponents().catch(n=>{R("error","error querying components",n),super.emit("queryError",n)}),this.emit("connected",this)}async _handleWebSocketMessage(e){if(!e)return;let{meta:t,payload:n}=e;R("verbose","[event.currentApplicationState]",t.currentApplicationState);let o=!t.platformDirective,i=t.currentApplicationState.applicationStateCode;if(t.messageCode==="SESSION_TIMEOUT"&&super.emit("sessionTimeout",t.messageCode),!i)throw this.connection._socket?.close(),new Error("Platform in invalid state. Cannot continue.");if(i!==this.state){let s=this.state;R("verbose",`[state changed] old:${s} new:${i}`),this._currentState=new Q(s,i),super.emit("stateChange",this._currentState),i==="UNAVAILABLE"?(await this.queryComponents().catch(p=>{R("error","error querying components",p),super.emit("queryError",p)}),this._online&&this.checkRequiredComponentsAndSyncState()):i==="ACTIVE"&&(this.multiTenant=n?.applicationActivation?.executionMode==="MAM",this.accessibleMode=n?.applicationActivation?.accessibleMode||!1,this.language=n?.applicationActivation?.languageID||"en-US",super.emit("activated",n?.applicationActivation)),s==="ACTIVE"&&super.emit("deactivated",i)}if(typeof t.componentID=="number"&&this.components){let s=this.components[t.componentID];s&&s.stateIsDifferent(e)&&(s.updateState(e),super.emit("componentStateChange",s),this._online&&(o||t.platformDirective==="peripherals_query")&&this.checkRequiredComponentsAndSyncState())}R("verbose","[socket.onmessage]",e),super.emit("message",e)}api={getEnvironment:async()=>{this._ensureConnected();let e=D.applicationData("platform_environment"),t=await this.connection.sendAndGetResponse(e);return R("verbose","[getEnvironment()] response",t),this.environment=t.payload?.environmentLevel,this.environment},getComponents:async()=>{this._ensureConnected();let e=D.applicationData("platform_components"),t=await this.connection.sendAndGetResponse(e);R("verbose","[getComponents()] response",t);let n=t.payload?.componentList;if(this.components)return n;let o=this.components={};return n.forEach(i=>{let s=String(i.componentID),p;if(Ct(i))p=new U(i,this);else if(Ot(i))p=new M(i,this);else return;return o[s]=p}),n.forEach(i=>{let s=String(i.componentID),p;if(kt(i))p=this.announcement=new Se(i,this);else if(Wt(i))p=this.bagTagPrinter=new le(i,this);else if(Kt(i))p=this.boardingPassPrinter=new _e(i,this);else if(qt(i))p=this.documentReader=new se(i,this);else if(jt(i))p=this.barcodeReader=new oe(i,this);else if($t(i))p=this.cardReader=new ae(i,this);else if(Xt(i))p=this.keypad=new ue(i,this);else if(Qt(i))p=this.biometric=new Re(i,this);else if(Zt(i))p=this.scale=new pe(i,this);else if(en(i))p=this.camera=new me(i,this);else if(tn(i))p=this.insertionBelt=new Pe(i,this);else if(on(i))p=this.verificationBelt=new De(i,this);else if(nn(i))p=this.parkingBelt=new fe(i,this);else if(rn(i))p=this.rfid=new Ee(i,this);else if(an(i))p=this.bhs=new Ae(i,this);else if(sn(i))p=this.aeasbd=new ce(i,this);else{if(Ct(i))return;if(Ot(i))return;zt(i)?p=this.illumination=new de(i,this):Jt(i)?p=this.headset=new Te(i,this):p=new $(i,this)}return o[s]=p}),n},getStatus:async e=>{this._ensureConnected(),R("verbose",`[getStatus()] querying component with ID: ${e}`);let t=D.applicationData("peripherals_query",{componentID:e});R("verbose","[getStatus()] applicationData built:",t);let n=await this.connection.sendAndGetResponse(t);return R("verbose","[queryDevice()] response",n),n},send:async(e,t)=>{this._ensureConnected();let n=D.applicationData("peripherals_send",{componentID:e,dataObj:t});return await this.connection.sendAndGetResponse(n)},setup:async(e,t)=>{this._ensureConnected(),N(e);let n=D.applicationData("peripherals_setup",{componentID:e,dataObj:t});return await this.connection.sendAndGetResponse(n)},cancel:async e=>{this._ensureConnected(),N(e);let t=D.applicationData("peripherals_cancel",{componentID:e});return await this.connection.sendAndGetResponse(t)},enable:async e=>{this._ensureConnected(),N(e);let t=D.applicationData("peripherals_userpresent_enable",{componentID:e});return await this.connection.sendAndGetResponse(t)},disable:async e=>{this._ensureConnected(),N(e);let t=D.applicationData("peripherals_userpresent_disable",{componentID:e});return await this.connection.sendAndGetResponse(t)},offer:async e=>{this._ensureConnected(),N(e);let t=D.applicationData("peripherals_userpresent_offer",{componentID:e});return await this.connection.sendAndGetResponse(t)},staterequest:async(e,t="NOT_APPLICABLE",n="")=>{if(this._ensureConnected(),this.pendingStateChange)return Promise.resolve(void 0);R("info",`Requesting ${e} state`),this.pendingStateChange=e;let o;try{let i=D.stateChange(e,t,n);return o=await this.connection.sendAndGetResponse(i),o}finally{this.pendingStateChange=void 0}},announcement:{play:async(e,t)=>{this._ensureConnected(),N(e);let n=[{data:t,dsTypes:["DS_TYPES_SSML"]}],o=D.applicationData("peripherals_announcement_play",{componentID:e,dataObj:n});return await this.connection.sendAndGetResponse(o)},pause:async e=>{this._ensureConnected(),N(e);let t=D.applicationData("peripherals_announcement_pause",{componentID:e});return await this.connection.sendAndGetResponse(t)},resume:async e=>{this._ensureConnected(),N(e);let t=D.applicationData("peripherals_announcement_resume",{componentID:e});return await this.connection.sendAndGetResponse(t)},stop:async e=>{this._ensureConnected(),N(e);let t=D.applicationData("peripherals_announcement_stop",{componentID:e});return await this.connection.sendAndGetResponse(t)}}};async _disableAllComponents(){if(this.components){let e=Object.values(this.components);for await(let t of e)t.enabled&&await t.disable()}}async requestInitializeState(){return this._ensureConnected(),this.state==="STOPPED"?await this.api.staterequest("INITIALIZE"):Promise.resolve(void 0)}async requestUnavailableState(){this._ensureConnected();let e=this.state==="INITIALIZE"||this.state==="AVAILABLE"||this.state==="ACTIVE";return e&&this.state==="ACTIVE"&&await this._disableAllComponents(),e?this.api.staterequest("UNAVAILABLE"):Promise.resolve(void 0)}async requestAvailableState(){this._ensureConnected();let e=this.state==="UNAVAILABLE"||this.state==="ACTIVE";return e&&this.state==="ACTIVE"&&await this._disableAllComponents(),e?this.api.staterequest("AVAILABLE"):Promise.resolve(void 0)}async requestActiveState(){return this._ensureConnected(),await(this.state==="AVAILABLE"||this.state==="ACTIVE"?this.api.staterequest("ACTIVE"):Promise.resolve(void 0))}async requestStoppedState(){return this._ensureConnected(),await this.api.staterequest("STOPPED")}async requestReload(){return this._ensureConnected(),!this.state||this.state==="UNAVAILABLE"||this.state==="AVAILABLE"||this.state==="ACTIVE"?(await this.api.staterequest("RELOAD"),this.connection._socket?.close(1001,"Reloading"),!0):Promise.resolve(!1)}async queryComponents(){if(!this.components)return!1;let e=Object.values(this.components);return await Promise.all(e.map(t=>t.query().catch(n=>n))),!0}get unavailableComponents(){return Object.values(this.components||{}).filter(t=>!t.ready)}get unavailableRequiredComponents(){return this.unavailableComponents.filter(e=>e.required)}checkRequiredComponentsAndSyncState(){if(!this.pendingStateChange)if(this._online){let e=this.unavailableRequiredComponents;e.length?(R("verbose","[checkRequiredComponentsAndSyncState] Required components UNAVAILABLE:",e.map(t=>t.constructor.name)),this.requestUnavailableState()):this.state==="UNAVAILABLE"&&(R("verbose","[checkRequiredComponentsAndSyncState] All required components OK \u2705. Ready for AVAILABLE state."),this.requestAvailableState())}else this.components&&this.requestUnavailableState()}_online=!1;get applicationOnline(){return this._online}set applicationOnline(e){this._online=e,this.checkRequiredComponentsAndSyncState()}};return Bt(pn);})();
//# sourceMappingURL=cuss2.min.js.map

// Appended wrapper to expose Cuss2 exports onto a global Cuss2 object
;(function(globalCtx) {
  if (typeof Cuss2 === 'undefined') {
    console.error('Cuss2 not found. The bundle might have failed to load or was not generated correctly.');
    return;
  }
  // The IIFE bundle creates a global 'Cuss2' object containing all exports
  const _c2 = Cuss2;
  
  // The Cuss2 constructor should be at _c2.Cuss2
  if (_c2.Cuss2 && typeof _c2.Cuss2.connect === 'function') {
    // Make the Cuss2 constructor the main export
    const Cuss2Constructor = _c2.Cuss2;
    
    // Copy all other exports as properties on the constructor
    for (const key in _c2) {
      if (Object.prototype.hasOwnProperty.call(_c2, key)) {
        Cuss2Constructor[key] = _c2[key];
      }
    }
    
    globalCtx.Cuss2 = Cuss2Constructor;
  } else {
    // Fallback: just expose the whole bundle
    globalCtx.Cuss2 = _c2;
  }
  // Move StateChange and LogMessage to Models namespace if they exist
  if (globalCtx.Cuss2.Models && _c2.StateChange) {
    globalCtx.Cuss2.Models.StateChange = _c2.StateChange;
    delete globalCtx.Cuss2.StateChange;
  }
  if (globalCtx.Cuss2.Models && _c2.LogMessage) {
    globalCtx.Cuss2.Models.LogMessage = _c2.LogMessage;
    delete globalCtx.Cuss2.LogMessage;
  }

  // Add version info (consider making this dynamic, e.g., from a version file or package.json)
  globalCtx.Cuss2.version = "1.0.12";
})(typeof window !== 'undefined' ? window : typeof globalThis !== 'undefined' ? globalThis : this);
